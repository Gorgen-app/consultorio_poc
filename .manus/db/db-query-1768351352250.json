{
  "query": "\nCREATE TABLE IF NOT EXISTS backup_history (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  tenant_id INT NOT NULL,\n  backup_type ENUM('full', 'incremental', 'transactional', 'offline') NOT NULL,\n  status ENUM('running', 'success', 'failed', 'validating') NOT NULL DEFAULT 'running',\n  started_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  completed_at TIMESTAMP NULL,\n  file_path VARCHAR(500) NOT NULL,\n  file_size_bytes BIGINT,\n  checksum_sha256 VARCHAR(64),\n  destination ENUM('s3_primary', 's3_secondary', 'offline_hd') DEFAULT 's3_primary',\n  database_records INT,\n  files_count INT,\n  error_message TEXT,\n  triggered_by ENUM('scheduled', 'manual', 'system') DEFAULT 'scheduled',\n  created_by_user_id INT,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  FOREIGN KEY (tenant_id) REFERENCES tenants(id)\n);\n\nCREATE TABLE IF NOT EXISTS backup_config (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  tenant_id INT NOT NULL UNIQUE,\n  backup_enabled BOOLEAN DEFAULT TRUE,\n  daily_backup_time VARCHAR(5) DEFAULT '03:00',\n  weekly_backup_day INT DEFAULT 0,\n  monthly_backup_day INT DEFAULT 1,\n  daily_retention_days INT DEFAULT 30,\n  weekly_retention_weeks INT DEFAULT 12,\n  monthly_retention_months INT DEFAULT 12,\n  notify_on_success BOOLEAN DEFAULT FALSE,\n  notify_on_failure BOOLEAN DEFAULT TRUE,\n  notification_email VARCHAR(255),\n  offline_backup_enabled BOOLEAN DEFAULT TRUE,\n  offline_backup_reminder_day INT DEFAULT 1,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  FOREIGN KEY (tenant_id) REFERENCES tenants(id)\n);\n",
  "command": "mysql --batch --raw --column-names --default-character-set=utf8mb4 --host gateway03.us-east-1.prod.aws.tidbcloud.com --port 4000 --user 2eJNWYGY92vZU3w.root --database TyeFpW5ykZHTuZXuk6iMG7 --execute \nCREATE TABLE IF NOT EXISTS backup_history (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  tenant_id INT NOT NULL,\n  backup_type ENUM('full', 'incremental', 'transactional', 'offline') NOT NULL,\n  status ENUM('running', 'success', 'failed', 'validating') NOT NULL DEFAULT 'running',\n  started_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  completed_at TIMESTAMP NULL,\n  file_path VARCHAR(500) NOT NULL,\n  file_size_bytes BIGINT,\n  checksum_sha256 VARCHAR(64),\n  destination ENUM('s3_primary', 's3_secondary', 'offline_hd') DEFAULT 's3_primary',\n  database_records INT,\n  files_count INT,\n  error_message TEXT,\n  triggered_by ENUM('scheduled', 'manual', 'system') DEFAULT 'scheduled',\n  created_by_user_id INT,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  FOREIGN KEY (tenant_id) REFERENCES tenants(id)\n);\n\nCREATE TABLE IF NOT EXISTS backup_config (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  tenant_id INT NOT NULL UNIQUE,\n  backup_enabled BOOLEAN DEFAULT TRUE,\n  daily_backup_time VARCHAR(5) DEFAULT '03:00',\n  weekly_backup_day INT DEFAULT 0,\n  monthly_backup_day INT DEFAULT 1,\n  daily_retention_days INT DEFAULT 30,\n  weekly_retention_weeks INT DEFAULT 12,\n  monthly_retention_months INT DEFAULT 12,\n  notify_on_success BOOLEAN DEFAULT FALSE,\n  notify_on_failure BOOLEAN DEFAULT TRUE,\n  notification_email VARCHAR(255),\n  offline_backup_enabled BOOLEAN DEFAULT TRUE,\n  offline_backup_reminder_day INT DEFAULT 1,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  FOREIGN KEY (tenant_id) REFERENCES tenants(id)\n);\n",
  "rows": [],
  "messages": [],
  "stdout": "",
  "stderr": "",
  "execution_time_ms": 69
}