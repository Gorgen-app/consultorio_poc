{
  "query": "-- Adicionar colunas de redes sociais à tabela medico_links\nALTER TABLE medico_links \nADD COLUMN IF NOT EXISTS instagram VARCHAR(200),\nADD COLUMN IF NOT EXISTS facebook VARCHAR(500),\nADD COLUMN IF NOT EXISTS twitter VARCHAR(200),\nADD COLUMN IF NOT EXISTS tiktok VARCHAR(200);\n\n-- Criar tabela de senhas dos usuários\nCREATE TABLE IF NOT EXISTS user_passwords (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  user_id INT NOT NULL UNIQUE,\n  password_hash VARCHAR(255) NOT NULL,\n  salt VARCHAR(64) NOT NULL,\n  last_changed_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  must_change_on_login BOOLEAN DEFAULT FALSE,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  FOREIGN KEY (user_id) REFERENCES users(id)\n);\n\n-- Criar tabela de tokens de recuperação de senha\nCREATE TABLE IF NOT EXISTS password_reset_tokens (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  user_id INT NOT NULL,\n  token VARCHAR(64) NOT NULL UNIQUE,\n  expires_at TIMESTAMP NOT NULL,\n  used_at TIMESTAMP NULL,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  FOREIGN KEY (user_id) REFERENCES users(id)\n);\n\n-- Criar tabela de documentos do médico\nCREATE TABLE IF NOT EXISTS medico_documentos (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  user_profile_id INT NOT NULL,\n  tipo ENUM('diploma_graduacao', 'carteira_conselho', 'certificado_especializacao', 'certificado_residencia', 'certificado_mestrado', 'certificado_doutorado', 'certificado_curso', 'outro') NOT NULL,\n  titulo VARCHAR(255) NOT NULL,\n  descricao TEXT,\n  arquivo_url VARCHAR(500) NOT NULL,\n  arquivo_key VARCHAR(255) NOT NULL,\n  arquivo_nome VARCHAR(255) NOT NULL,\n  arquivo_tamanho INT,\n  formacao_id INT,\n  especializacao_id INT,\n  deleted_at TIMESTAMP NULL,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL\n);\n\n-- Criar tabela de foto de perfil\nCREATE TABLE IF NOT EXISTS user_profile_photos (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  user_id INT NOT NULL UNIQUE,\n  foto_url VARCHAR(500) NOT NULL,\n  foto_key VARCHAR(255) NOT NULL,\n  foto_nome VARCHAR(255),\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  FOREIGN KEY (user_id) REFERENCES users(id)\n);",
  "command": "mysql --batch --raw --column-names --default-character-set=utf8mb4 --host gateway03.us-east-1.prod.aws.tidbcloud.com --port 4000 --user 2eJNWYGY92vZU3w.root --database TyeFpW5ykZHTuZXuk6iMG7 --execute -- Adicionar colunas de redes sociais à tabela medico_links\nALTER TABLE medico_links \nADD COLUMN IF NOT EXISTS instagram VARCHAR(200),\nADD COLUMN IF NOT EXISTS facebook VARCHAR(500),\nADD COLUMN IF NOT EXISTS twitter VARCHAR(200),\nADD COLUMN IF NOT EXISTS tiktok VARCHAR(200);\n\n-- Criar tabela de senhas dos usuários\nCREATE TABLE IF NOT EXISTS user_passwords (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  user_id INT NOT NULL UNIQUE,\n  password_hash VARCHAR(255) NOT NULL,\n  salt VARCHAR(64) NOT NULL,\n  last_changed_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  must_change_on_login BOOLEAN DEFAULT FALSE,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  FOREIGN KEY (user_id) REFERENCES users(id)\n);\n\n-- Criar tabela de tokens de recuperação de senha\nCREATE TABLE IF NOT EXISTS password_reset_tokens (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  user_id INT NOT NULL,\n  token VARCHAR(64) NOT NULL UNIQUE,\n  expires_at TIMESTAMP NOT NULL,\n  used_at TIMESTAMP NULL,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  FOREIGN KEY (user_id) REFERENCES users(id)\n);\n\n-- Criar tabela de documentos do médico\nCREATE TABLE IF NOT EXISTS medico_documentos (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  user_profile_id INT NOT NULL,\n  tipo ENUM('diploma_graduacao', 'carteira_conselho', 'certificado_especializacao', 'certificado_residencia', 'certificado_mestrado', 'certificado_doutorado', 'certificado_curso', 'outro') NOT NULL,\n  titulo VARCHAR(255) NOT NULL,\n  descricao TEXT,\n  arquivo_url VARCHAR(500) NOT NULL,\n  arquivo_key VARCHAR(255) NOT NULL,\n  arquivo_nome VARCHAR(255) NOT NULL,\n  arquivo_tamanho INT,\n  formacao_id INT,\n  especializacao_id INT,\n  deleted_at TIMESTAMP NULL,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL\n);\n\n-- Criar tabela de foto de perfil\nCREATE TABLE IF NOT EXISTS user_profile_photos (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  user_id INT NOT NULL UNIQUE,\n  foto_url VARCHAR(500) NOT NULL,\n  foto_key VARCHAR(255) NOT NULL,\n  foto_nome VARCHAR(255),\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  FOREIGN KEY (user_id) REFERENCES users(id)\n);",
  "rows": [],
  "messages": [],
  "stdout": "",
  "stderr": "",
  "execution_time_ms": 2266
}